<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Permutation1 • Permutation1</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Permutation1">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Permutation1</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Permutation1.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Permutation1</h1>
                        <h4 class="author">Adrián Gómez &amp; Solveig Østergaard</h4>
            
      
      
      <div class="hidden name"><code>Permutation1.Rmd</code></div>

    </div>

    
    
<p>The purpose of this package is to have some nice, userfriendly functions, that does permutations in a way that is easy to understand. All of them gives a plot and a statistical value plus a p-value.</p>
<p>All the functions need a dataset (in dataframe format) with data that you want to test somehow with permutation tests. The functions also have the possibility of making plots showing the permuted null-distribution including the observed value. We recommend installing ggplot2 (part of the tidyverse as well) for this, if you want nice plots and changing the gg_plot variable to TRUE. We have different functions depending on what statistical value you want to test, and here we have examples of how to use them with simple random datasets.</p>
<div id="loading-the-libraries" class="section level5">
<h5 class="hasAnchor">
<a href="#loading-the-libraries" class="anchor"></a>Loading the libraries:</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Permutation1)</a></code></pre></div>
<pre><code>## Load required: ggplot2 
## Load required: magrittr</code></pre>
</div>
<div id="making-small-dataset-for-demonstrating-the-permutation-of-the-mean-and-the-median" class="section level5">
<h5 class="hasAnchor">
<a href="#making-small-dataset-for-demonstrating-the-permutation-of-the-mean-and-the-median" class="anchor"></a>Making small dataset for demonstrating the permutation of the mean and the median:</h5>
<p>This dataset is not normally distributed, and thereby it would make sense to run a permutation test to check if the groups have the same mean or median.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dv">50</span>,<span class="st">"Group1"</span>), <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dv">50</span>, <span class="st">"Group2"</span>))</a>
<a class="sourceLine" id="cb3-3" title="3">test &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>), <span class="dv">50</span>, <span class="dt">replace=</span>T), <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">30</span><span class="op">:</span><span class="dv">100</span>), <span class="dv">50</span>, <span class="dt">replace=</span>T)), names)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(test) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"value"</span>,<span class="st">"names"</span>)</a></code></pre></div>
</div>
<div id="using-permutation_mean" class="section level1">
<h1 class="hasAnchor">
<a href="#using-permutation_mean" class="anchor"></a>Using permutation_mean()</h1>
<p>for testing if the means of the same groups are significantly different: Here the null-distribution made by the permutation function will be distributed around 0.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_mean.html">permutation_mean</a></span>(test,<span class="st">"names"</span>,<span class="st">"value"</span>,<span class="st">"Group1"</span>,<span class="st">"Group2"</span>, <span class="dt">no_perm=</span><span class="dv">10000</span>, <span class="dt">plot=</span>T, <span class="dt">gg_plot=</span>ggplot_status, <span class="dt">progress=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Permutation1_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">p</a></code></pre></div>
<pre><code>## 
##  Permutation Test (Mean)
## 
## data:  Permutation for group: Group1 and Group2
## p-value = 3e-04
## sample estimates:
##         Mean first group        Mean second group Observed mean difference 
##                    49.30                    68.92                   -19.62</code></pre>
<p>Here we get a p-value of <span class="math inline">\(2.9997\times 10^{-4}\)</span>, and with a 5% significance level we can reject that the mean of the two groups are the same. The ggplot_status is TRUE or FALSE depending on whether or not you have ggplot2 installed on your computer.</p>
<p>The p-value is calculated as:</p>
<p><span class="math display">\[p-val = \frac{\sum (|PermutedValue|\ge |ObservedValue|)+1}{\#Permutations+1}\]</span></p>
<p>We add one as a precaution, since we do not know the value of the next permutation and thereby always should expect the “next” value to be at least as extreme as the observed. The test is two-sided</p>
<p>It is possible to acces the different values from the permutations test:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">p<span class="op">$</span>p.value</a></code></pre></div>
<pre><code>##    p-value 
## 0.00029997</code></pre>
</div>
<div id="using-permutation_median" class="section level1">
<h1 class="hasAnchor">
<a href="#using-permutation_median" class="anchor"></a>Using permutation_median()</h1>
<p>for testing if the median of the same groups are significantly different: Here the null-distribution made by the permutation function will be distributed around 0. This works the same way as the permutations_mean() function</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_median.html">permutation_median</a></span>(test,<span class="st">"names"</span>,<span class="st">"value"</span>,<span class="st">"Group1"</span>,<span class="st">"Group2"</span>, <span class="dt">no_perm=</span><span class="dv">10000</span>, <span class="dt">plot=</span>T, <span class="dt">gg_plot=</span>ggplot_status, <span class="dt">progress=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Permutation1_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">p</a></code></pre></div>
<pre><code>## 
##  Permutation Test (Median)
## 
## data:  Permutation for group: Group1 and Group2
## p-value = 0.007599
## sample estimates:
##         Median first group        Median second group 
##                         53                         68 
## Observed median difference 
##                        -15</code></pre>
<p>The median is also significantly different in the two groups with a significance level of 5%.</p>
<div id="making-small-dataset-for-demonstrating-the-permutation-two-different-linear-models" class="section level5">
<h5 class="hasAnchor">
<a href="#making-small-dataset-for-demonstrating-the-permutation-two-different-linear-models" class="anchor"></a>Making small dataset for demonstrating the permutation two different linear models:</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span>), <span class="dv">100</span>, <span class="dt">replace=</span>T)</a>
<a class="sourceLine" id="cb12-3" title="3">y &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">50</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">10</span><span class="op">:</span><span class="dv">10</span>), <span class="dv">100</span>, <span class="dt">replace=</span>T)</a>
<a class="sourceLine" id="cb12-4" title="4">data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(x,y)</a></code></pre></div>
<p>We know that a qudratic model, <span class="math inline">\(x^2\)</span>, should fit the data the best, but it is allways a good ide to look at the data making a simple plot, since it is nice to see the dependence between the variables: <img src="Permutation1_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Here we can actually see, that there probably is a quadratic depencence between x and y.</p>
</div>
</div>
<div id="using-permutation_lm" class="section level1">
<h1 class="hasAnchor">
<a href="#using-permutation_lm" class="anchor"></a>Using permutation_lm()</h1>
<p>for testing if the quadratic model fits the data significantly better than the linear model Here the null-distribution will mimic an F-distribution</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_lm.html">permutation_lm</a></span>(data, <span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"quadratic"</span>, <span class="st">"linear"</span>, <span class="dt">plot=</span>T, <span class="dt">gg_plot=</span>ggplot_status, <span class="dt">progress=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Permutation1_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">p</a></code></pre></div>
<pre><code>## 
##  Permutation Test (ANOVA) for quadratic and linear models
## 
## data:  Permutation for predictor x and response y
## p-value = 9.999e-05
## sample estimates:
## Observed F value between models 
##                        33.45256</code></pre>
<p>We also get an extremely low p-value, that tells us, that we reject the linear model being as good as the quadratic, and we would therefore expect the quadratic model to fit our data better than the linear model.</p>
<p>Here the p-value is calculated as:</p>
<p><span class="math display">\[p-val = \frac{\sum (PermutedValue\ge ObservedValue)+1}{\#Permutations+1}\]</span> Since it is an F-distributed null-model, all values will be above 0, and we do not need to take the aboslute values.</p>
<p>We could also check if the cubic model works better than the quadratic model then:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_lm.html">permutation_lm</a></span>(data, <span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"cubic"</span>,<span class="st">"quadratic"</span>, <span class="dt">plot=</span>T, <span class="dt">gg_plot=</span>ggplot_status, <span class="dt">progress=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Permutation1_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">p</a></code></pre></div>
<pre><code>## 
##  Permutation Test (ANOVA) for cubic and quadratic models
## 
## data:  Permutation for predictor x and response y
## p-value = 0.8302
## sample estimates:
## Observed F value between models 
##                      0.04548759</code></pre>
<p>Here we can see, that the p-value is high, and we would therefore not expect the cubic model to be better.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#using-permutation_mean">Using permutation_mean()</a></li>
      <li><a href="#using-permutation_median">Using permutation_median()</a></li>
      <li><a href="#using-permutation_lm">Using permutation_lm()</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
